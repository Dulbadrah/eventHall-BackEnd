generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Venue {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  location    String
  capacity    Int
  price       String
  images      String[]

  owner   User @relation("OwnerVenues", fields: [ownerId], references: [id])
  ownerId Int

  admin   User @relation("AdminVenues", fields: [adminId], references: [id])
  adminId Int

  bookings Booking[]
  reviews  Review[]

  adminApproval Status @default(PENDING)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Status {
  PENDING
  APPROVED
  REJECTED
}

model User {
  id       Int    @id @default(autoincrement())
  name     String
  email    String @unique
  password String
  role     Role   @default(USER)

  venues      Venue[] @relation("OwnerVenues")
  adminVenues Venue[] @relation("AdminVenues")

  bookings  Booking[]
  reviews   Review[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Booking {
  id         Int           @id @default(autoincrement())
  user       User          @relation(fields: [userId], references: [id])
  userId     Int
  venue      Venue         @relation(fields: [venueId], references: [id])
  venueId    Int
  eventDate  DateTime
  guestCount Int
  notes      String?
  status     BookingStatus @default(PENDING)
  createdAt  DateTime      @default(now())
  updatedAt  DateTime      @updatedAt
}

model Review {
  id         Int      @id @default(autoincrement())
  user       User     @relation(fields: [userId], references: [id])
  userId     Int
  venue      Venue    @relation(fields: [venueId], references: [id])
  venueId    Int
  rating     Int      @default(1) // 1-5 хүртэлх үнэлгээ
  text       String?
  helpful    Int      @default(0)
  isPublic   Boolean  @default(true)
  isVerified Boolean  @default(false)
  comment    String?
  createdAt  DateTime @default(now())
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
}

enum Role {
  USER
  ADMIN
  SUPER_ADMIN
}
