
generator client {
  provider = "prisma-client-js"
}

datasource db { 
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Venue {
  id          Int       @id @default(autoincrement())
  name        String
  description String?
  location    String
  capacity    Int
  price       Float
  rating      Int
  amenities   Amenity[] @relation("VenueAmenities")
  images      String[] // Cloudinary эсвэл бусад file storage URL-ууд
  tags        String[]

  // Эзэн
  Super_Admin User @relation("Super_AdminVenues", fields: [Super_AdminId], references: [id])
  Super_AdminId     Int

  // Админ
  admin   User @relation("AdminVenues", fields: [adminId], references: [id])
  adminId Int

  bookings  Booking[]
  reviews   Review[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}


// model EventType {
//   id      Int     @id @default(autoincrement())
//   name    String
//   venue   Venue?  @relation(fields: [venueId], references: [id])
//   venueId Int?
// }

model User {
  id       Int    @id @default(autoincrement())
  name     String
  email    String @unique
  password String
  role     Role   @default(ADMIN)

  // Эзэмшдэг venue-үүд
  venues Venue[] @relation("Super_AdminVenues")

  // Хянадаг venue-үүд
  adminVenues Venue[] @relation("AdminVenues")

  bookings  Booking[]
  reviews   Review[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Booking {
  id         Int           @id @default(autoincrement())
  user       User          @relation(fields: [userId], references: [id])
  userId     Int
  venue      Venue         @relation(fields: [venueId], references: [id])
  venueId    Int
  eventDate  DateTime
  guestCount Int
  notes      String?
  status     BookingStatus @default(PENDING)
  createdAt  DateTime      @default(now())
  updatedAt  DateTime      @updatedAt
}

model Amenity {
  id     Int     @id @default(autoincrement())
  name   String
  venues Venue[] @relation("VenueAmenities")
}

model Review {
  id        Int      @id @default(autoincrement())
  user      User     @relation(fields: [userId], references: [id])
  userId    Int
  venue     Venue    @relation(fields: [venueId], references: [id])
  venueId   Int
  rating    Int //1-5 star
  comment   String?
  createdAt DateTime @default(now())
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
}

enum Role {
  USER
  ADMIN
  SUPER_ADMIN
}
